<% require 'sanitize' %>
<h2><%= @program.name %>, <%= @year.year %></h2>
<div>

	<ul class="tabs">
		<% @tabs.each do |tab| %>
			<li><a href="#<%= tab.name %>"><%= tab.name.humanize %></a></li>
		<% end %>
	</ul>

	<% @tabs.each do |tab| %>
		<div class="tab" id="<%= tab.name %>">
			<% questions = Question.where(tab_id: tab.id).order(:position) %>
			<% questions.each do |question| %>
				<div class="row answer-partial">
					<div>
						<!-- Allowing formatting input by admin, but escaping most tags using Sanitize gem -->
						<strong><%= raw Sanitize.fragment(question.question, Sanitize::Config::RESTRICTED) %></strong>
					</div>
					<% answer = answer_for_question(question, @program, @year) %>
					<% if answer.blank? %>
						<div id="static_answer_<%= question.id %>">
							<!-- Allowing formatting input by user, but escaping most tags using Sanitize gem -->
							<%# raw Sanitize.fragment(@answer.answer, Sanitize::Config::RESTRICTED) %>
							<a href="" class="toggleLink new_<%= question.id %>" id="<%= question.id %>">New</a>
							<div class="toggleField" id="field_<%= question.id %>" style="display: none;">
								<%= render partial: "answers/new", locals: { year: @year, program: @program, question: question } %>
							</div>
						</div>
					<% else %>
						<div id="static_answer_<%= answer.id %>">
							<!-- Allowing formatting input by user, but escaping most tags using Sanitize gem -->
							<%= raw answer.answer %>
							<a href="" class="toggleLink" id="<%= question.id %>">Edit</a>
							<div class="toggleField" id="field_<%= question.id %>" style="display: none;">
								<%= render partial: "answers/edit", locals: { year: @year, program: @program, question: question } %>
							</div>
						</div>
					<% end %>
				</div>
			<% end %>
		</div>
	<% end %>

</div>
